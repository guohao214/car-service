webpackJsonp([22],{"7h5j":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("Icdr");a("GbHy"),a("4UDB"),a("Oq2I"),a("miEh");var l={computed:{rules:function(){return{}}},data:function(){return{listFilter:{page:1,start:0,length:10,product:"",supplier:"",type:""},handleFilterLoading:!1,handleExportLoading:!1,listLoading:!1,list:[],total:0,addForm:{brand:"",product:"",count:"",unit_price:"",total_price:"",type:"",storage_type:"",project_num:"",project_name:"",stock_type:"",warehouse:"",purchase_num:"",supplier:"",account:"",bill_month:"",bill_date:"",team:"",partyB:"",business_mode:"",date:"",comment:"",mod:1},addLoading:!1,addFormVisible:!1,outFormVisible:!1,product_array:[],project_array:[],maxCount:0,datePickable:{disabledDate:function(e){return e.getTime()>Date.now()-864e4}}}},mounted:function(){this.getList()},methods:{handleFilter:function(){this.listFilter.page=1,this.getList()},getList:function(){var e=this;this.$refs.filterForm.validate(function(t){t&&(e.listLoading=!0,e.$http.postDataEx("device","searchStorageRecord",{product:e.listFilter.product,supplier:e.listFilter.supplier,type:e.listFilter.type,page:e.listFilter.page-1,length:e.listFilter.length},function(t){0==t.code&&(e.list=t.data.list,e.total=Number(t.data.count)),e.listLoading=!1}))})},mergeList:function(e){e.edit=!1,this.list.push(e)},handleSizeChange:function(e){this.listFilter.length=e,this.listFilter.page=1,this.listFilter.start=0,this.getList()},handleCurrentChange:function(e){this.listFilter.page=e,this.listFilter.start=this.listFilter.length*(e-1),this.getList()},changeRangeType:function(){this.listFilter.date=null},getProductFromStock:function(){this.product_array=[];var e=this;this.$http.postDataEx("device","getProductFromStock",{},function(t){0==t.code&&t.data.forEach(function(t,a){var l=[];l.value=t.product,l.label=t.product,e.product_array.push(l)})})},getProjectFromStock:function(){this.project_array=[];var e=this;this.$http.postDataEx("device","getProjectFromStock",{},function(t){0==t.code&&t.data.forEach(function(t,a){var l=[];l.value=t.project_name,l.label=t.project_name,e.project_array.push(l)})})},getProductCountFromStock:function(){var e=this;""!=e.addForm.product&&""!=e.addForm.project_name&&this.$http.postDataEx("device","getProductCountFromStock",{product:this.addForm.product,project_name:this.addForm.project_name},function(t){if(0==t.code){var a=t.data;e.maxCount=parseInt(a[0].count),e.addForm.unit_price=a[0].unit_price,e.addForm.brand=a[0].brand,e.addForm.purchase_num=a[0].purchase_num,e.addForm.project_num=a[0].project_num,supplier,e.addForm.supplier=a[0].supplier}})},showAddForm:function(){this.addFormVisible=!0,this.initAddForm(this.addForm)},showOutForm:function(){this.outFormVisible=!0,this.initAddForm(this.addForm),this.getProductFromStock(),this.getProjectFromStock()},createSubmit:function(e){var t=this;this.addLoading=!0,this.$refs[e].validate(function(e){e?(t.addForm.total_price=t.addForm.unit_price*t.addForm.count,t.$http.postDataEx("device","updateStorageRecord",t.addForm,function(e){0==e.code?(t.$notify({title:"成功",message:"操作成功",type:"success"}),t.addFormVisible=!1,t.outFormVisible=!1,t.initAddForm(t.addForm),t.getList()):t.$notify({title:"警告",message:"请先确认信息是否填写正确",type:"warning"}),t.addLoading=!1})):(t.$notify({title:"警告",message:"请先确认信息是否填写正确",type:"warning"}),t.addLoading=!1)})},initAddForm:function(e){for(var t in e)e[t]=""},resetForm:function(e){this.$refs[e].resetFields(),this.maxCount=0},handleExport:function(){var e=this;this.$refs.filterForm.validate(function(t){t&&(e.handleExportLoading=!0,e.$http.postDataEx("device","exportDeviceStorageRecord",{product:e.listFilter.product,supplier:e.listFilter.supplier,type:e.listFilter.type},function(t){0==t.code&&window.open(t.data.info),e.handleExportLoading=!1}))})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"storage_manager"},[a("el-row",{attrs:{gutter:12}},[a("div",{staticClass:"filter-container"},[a("el-form",{ref:"filterForm",attrs:{inline:!0,model:e.listFilter,rules:e.rules}},[a("el-form-item",{attrs:{label:"产品名",prop:"product"}},[a("el-input",{attrs:{placeholder:"请输入产品名",clearable:""},model:{value:e.listFilter.product,callback:function(t){e.$set(e.listFilter,"product",t)},expression:"listFilter.product"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"供应商",prop:"supplier"}},[a("el-input",{attrs:{placeholder:"请输入供应商",clearable:""},model:{value:e.listFilter.supplier,callback:function(t){e.$set(e.listFilter,"supplier",t)},expression:"listFilter.supplier"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"supplier"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择类型"},model:{value:e.listFilter.type,callback:function(t){e.$set(e.listFilter,"type",t)},expression:"listFilter.type"}},[a("el-option",{attrs:{label:"入库",value:"入库"}}),e._v(" "),a("el-option",{attrs:{label:"出库",value:"出库"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search",loading:e.handleFilterLoading},on:{click:e.handleFilter}},[e._v(e._s(e.$t("common.search")))]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:e.showAddForm}},[e._v("入库")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:e.showOutForm}},[e._v("出库")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"info",icon:"el-icon-download",disabled:e.handleExportLoading,loading:e.handleExportLoading},on:{click:e.handleExport}},[e._v(e._s(e.$t("common.export")))])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"dataTable",attrs:{data:e.list,height:"500",fit:"","highlight-current-row":"",stripe:""}},[a("el-table-column",{attrs:{prop:"brand",label:"品牌"}}),e._v(" "),a("el-table-column",{attrs:{prop:"product",label:"产品"}}),e._v(" "),a("el-table-column",{attrs:{prop:"count",label:"数量"}}),e._v(" "),a("el-table-column",{attrs:{prop:"unit_price",label:"单价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"total_price",label:"总价"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"storage_type",label:"出入库类型",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stock_type",label:"库存类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"project_num",label:"项目编号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"project_name",label:"项目名称",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"warehouse",label:"仓库"}}),e._v(" "),a("el-table-column",{attrs:{prop:"purchase_num",label:"采购编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"supplier",label:"供应商名称",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"account",label:"核算单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bill_month",label:"记账月"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bill_date",label:"单据生成日期",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{prop:"team",label:"归属业务团队",width:"110"}}),e._v(" "),a("el-table-column",{attrs:{prop:"partyB",label:"乙方"}}),e._v(" "),a("el-table-column",{attrs:{prop:"business_mode",label:"业务模式"}}),e._v(" "),a("el-table-column",{attrs:{prop:"date",label:"出入库日期",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"备注"}})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listFilter.page,"page-sizes":[10,20,30,50],"page-size":e.listFilter.length,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"入库",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",staticClass:"demo-ruleForm",attrs:{model:e.addForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"品牌",prop:"brand"}},[a("el-input",{model:{value:e.addForm.brand,callback:function(t){e.$set(e.addForm,"brand",t)},expression:"addForm['brand']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"产品",prop:"product",rules:[{required:!0,message:"产品不能为空"}]}},[a("el-input",{model:{value:e.addForm.product,callback:function(t){e.$set(e.addForm,"product",t)},expression:"addForm['product']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"数量",prop:"count",rules:[{required:!0,message:"数量不能为空"},{type:"number",message:"数量必须为数字值"}]}},[a("el-input",{model:{value:e.addForm.count,callback:function(t){e.$set(e.addForm,"count",e._n(t))},expression:"addForm['count']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单价",prop:"unit_price",rules:[{required:!0,message:"单价不能为空"},{type:"number",message:"单价必须为数字值"}]}},[a("el-input",{model:{value:e.addForm.unit_price,callback:function(t){e.$set(e.addForm,"unit_price",e._n(t))},expression:"addForm['unit_price']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm['type']"}},[a("el-option",{attrs:{label:"入库",value:"入库"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"入库类型",prop:"storage_type",rules:[{required:!0,message:"入库类型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择出入库类型"},model:{value:e.addForm.storage_type,callback:function(t){e.$set(e.addForm,"storage_type",t)},expression:"addForm['storage_type']"}},[a("el-option",{attrs:{label:"采购入库",value:"采购入库"}}),e._v(" "),a("el-option",{attrs:{label:"采购退货",value:"采购退货"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"库存类别",prop:"stock_type",rules:[{required:!0,message:"库存类别型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择库存类别"},model:{value:e.addForm.stock_type,callback:function(t){e.$set(e.addForm,"stock_type",t)},expression:"addForm['stock_type']"}},[a("el-option",{attrs:{label:"项目设备",value:"项目设备"}}),e._v(" "),a("el-option",{attrs:{label:"库存",value:"库存"}}),e._v(" "),a("el-option",{attrs:{label:"固定资产",value:"固定资产"}}),e._v(" "),a("el-option",{attrs:{label:"财务设备",value:"财务设备"}}),e._v(" "),a("el-option",{attrs:{label:"低值易耗品",value:"低值易耗品"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"项目编号",prop:"project_num"}},[a("el-input",{model:{value:e.addForm.project_num,callback:function(t){e.$set(e.addForm,"project_num",t)},expression:"addForm['project_num']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"project_name",rules:[{required:!0,message:"项目名称不能为空"}]}},[a("el-input",{model:{value:e.addForm.project_name,callback:function(t){e.$set(e.addForm,"project_name",t)},expression:"addForm['project_name']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"仓库",prop:"warehouse"}},[a("el-input",{model:{value:e.addForm.warehouse,callback:function(t){e.$set(e.addForm,"warehouse",t)},expression:"addForm['warehouse']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"采购编号",prop:"purchase_num"}},[a("el-input",{model:{value:e.addForm.purchase_num,callback:function(t){e.$set(e.addForm,"purchase_num",t)},expression:"addForm['purchase_num']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"供应商名称",prop:"supplier",rules:[{required:!0,message:"供应商不能为空"}]}},[a("el-input",{model:{value:e.addForm.supplier,callback:function(t){e.$set(e.addForm,"supplier",t)},expression:"addForm['supplier']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"核算单位",prop:"account"}},[a("el-input",{model:{value:e.addForm.account,callback:function(t){e.$set(e.addForm,"account",t)},expression:"addForm['account']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"记账月",prop:"bill_month"}},[a("el-input",{model:{value:e.addForm.bill_month,callback:function(t){e.$set(e.addForm,"bill_month",t)},expression:"addForm['bill_month']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单据生成日期",prop:"bill_date"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":e.datePickable},model:{value:e.addForm.bill_date,callback:function(t){e.$set(e.addForm,"bill_date",t)},expression:"addForm['bill_date']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"归属业务团队",prop:"team"}},[a("el-input",{model:{value:e.addForm.team,callback:function(t){e.$set(e.addForm,"team",t)},expression:"addForm['team']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"乙方",prop:"partyB"}},[a("el-input",{model:{value:e.addForm.partyB,callback:function(t){e.$set(e.addForm,"partyB",t)},expression:"addForm['partyB']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"业务模式",prop:"business_mode"}},[a("el-input",{model:{value:e.addForm.business_mode,callback:function(t){e.$set(e.addForm,"business_mode",t)},expression:"addForm['business_mode']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"出入库日期",prop:"date",rules:[{required:!0,message:"日期不能为空"}]}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":e.datePickable},model:{value:e.addForm.date,callback:function(t){e.$set(e.addForm,"date",t)},expression:"addForm['date']"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"comment"}},[a("el-input",{model:{value:e.addForm.comment,callback:function(t){e.$set(e.addForm,"comment",t)},expression:"addForm['comment']"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("addForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:function(t){e.createSubmit("addForm")}}},[e._v("确定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"出库",visible:e.outFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.outFormVisible=t}}},[a("el-form",{ref:"addForm",staticClass:"demo-ruleForm",attrs:{model:e.addForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"产品",prop:"product",rules:[{required:!0,message:"产品不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择产品"},on:{change:e.getProductCountFromStock},model:{value:e.addForm.product,callback:function(t){e.$set(e.addForm,"product",t)},expression:"addForm['product']"}},e._l(e.product_array,function(e,t){return a("el-option",{attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"项目",prop:"project_name",rules:[{required:!0,message:"项目不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择项目"},on:{change:e.getProductCountFromStock},model:{value:e.addForm.project_name,callback:function(t){e.$set(e.addForm,"project_name",t)},expression:"addForm['project_name']"}},e._l(e.project_array,function(e,t){return a("el-option",{attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"type",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm['type']"}},[a("el-option",{attrs:{label:"出库",value:"出库"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"出库类型",prop:"storage_type",rules:[{required:!0,message:"出库类型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择出出库类型"},model:{value:e.addForm.storage_type,callback:function(t){e.$set(e.addForm,"storage_type",t)},expression:"addForm['storage_type']"}},[a("el-option",{attrs:{label:"销售领用",value:"销售领用"}}),e._v(" "),a("el-option",{attrs:{label:"销售退货",value:"销售退货"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"出入库日期",prop:"date",rules:[{required:!0,message:"日期不能为空"}]}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期","picker-options":e.datePickable},model:{value:e.addForm.date,callback:function(t){e.$set(e.addForm,"date",t)},expression:"addForm['date']"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"count"}},[a("el-input-number",{attrs:{min:1,max:e.maxCount,label:"数量"},model:{value:e.addForm.count,callback:function(t){e.$set(e.addForm,"count",e._n(t))},expression:"addForm['count']"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.outFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("addForm")}}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},on:{click:function(t){e.createSubmit("addForm")}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(l,o,!1,function(e){a("w40n")},null,null);t.default=r.exports},"uFZ/":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.box-class {\n  -webkit-box-shadow: 2px 0px 6px 0px #545554;\n          box-shadow: 2px 0px 6px 0px #545554;\n}\n",""])},w40n:function(e,t,a){var l=a("uFZ/");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a("rjj0")("05c39de2",l,!0)}});